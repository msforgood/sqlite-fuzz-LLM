{
  "target": { 
    "function": "btreeEndTransaction",
    "fc": "btree_010",
    "category": "B-Tree",
    "file": "btree.c",
    "line": 4312
  },
  "struct_spec": {
    "btree": {
      "pBt": "BtShared*",
      "db": "sqlite3*",
      "inTrans": "u8",
      "sharable": "u8",
      "locked": "u8",
      "hasIncrblobCur": "u8",
      "wantToLock": "int",
      "nBackup": "int",
      "pNext": "Btree*",
      "pPrev": "Btree*"
    },
    "btshared": {
      "pPager": "Pager*",
      "mutex": "sqlite3_mutex*",
      "nTransaction": "int",
      "inTransaction": "u8",
      "bDoTruncate": "u8",
      "autoVacuum": "u8",
      "incrVacuum": "u8"
    }
  },
  "validation_spec": {
    "memory_align": 8,
    "transaction_states": ["TRANS_NONE", "TRANS_READ", "TRANS_WRITE"],
    "max_transactions": 65535,
    "mutex_required": true,
    "btree_state": ["CURSOR_VALID", "CURSOR_INVALID"],
    "vdbe_count": {"min": 0, "max": 1000}
  },
  "fc_mapping": {
    "source": "btree.c:4312",
    "rationale": "btreeEndTransaction - Critical transaction cleanup function for B-Tree operations",
    "api_level": "internal"
  },
  "constraints": {
    "max_input_size": 4096,
    "min_input_size": 16,
    "endianness": "LE",
    "sqlite_version": "3.51.0",
    "requires_initialization": true
  },
  "notes": {
    "preconditions": [
      "sqlite3_initialize() called",
      "Valid Btree object created",
      "Transaction state properly set",
      "Mutex held on BtShared"
    ],
    "side_effects": [
      "Transaction state changed",
      "Shared cache table locks cleared",
      "Pager may be unlocked",
      "Read-only downgrade possible"
    ],
    "error_conditions": [
      "Invalid transaction state",
      "Mutex not held",
      "Corrupted Btree structure"
    ]
  }
}