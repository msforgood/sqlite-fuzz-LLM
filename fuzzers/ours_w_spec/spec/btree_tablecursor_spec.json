{
  "target": {
    "function_group": "btree_tablecursor",
    "functions": [
      {
        "function": "btreeCreateTable",
        "fc": "btree_007",
        "file": "btree.c", 
        "line": 10015
      },
      {
        "function": "btreeDropTable",
        "fc": "btree_008",
        "file": "btree.c",
        "line": 10289
      },
      {
        "function": "btreeCursor",
        "fc": "btree_009",
        "file": "btree.c",
        "line": 4661
      },
      {
        "function": "btreeCursorWithLock",
        "fc": "btree_010", 
        "file": "btree.c",
        "line": 4728
      }
    ],
    "category": "B-Tree",
    "subcategory": "Table/Cursor Management"
  },
  "struct_spec": {
    "btree": {
      "db": "sqlite3*",
      "pBt": "BtShared*",
      "inTrans": "u8",
      "sharable": "u8",
      "locked": "u8",
      "hasIncrblobCur": "u8",
      "wantToLock": "int",
      "nBackup": "int"
    },
    "btcursor": {
      "eState": "u8",
      "curFlags": "u8",
      "curPagerFlags": "u8", 
      "hints": "u8",
      "skipNext": "int",
      "pBtree": "Btree*",
      "aOverflow": "Pgno*",
      "pKey": "void*",
      "pBt": "BtShared*",
      "pNext": "BtCursor*"
    },
    "btshared": {
      "db": "sqlite3*",
      "pCursor": "BtCursor*",
      "pPage1": "MemPage*",
      "autoVacuum": "u8",
      "inTransaction": "u8",
      "btsFlags": "u16",
      "pageSize": "u32",
      "usableSize": "u32",
      "mutex": "sqlite3_mutex*"
    },
    "keyinfo": {
      "nKeyField": "u32",
      "enc": "u8",
      "db": "sqlite3*",
      "aSortFlags": "u8*",
      "aColl": "CollSeq**",
      "aKeyField": "u16*"
    },
    "table_creation": {
      "rootPageno": "Pgno",
      "createTabFlags": "int",
      "ptfFlags": "int",
      "moveOperations": "int"
    }
  },
  "validation_spec": {
    "memory_align": 8,
    "page_size": {"min": 512, "max": 65536},
    "pgno_range": {"min": 1, "max": 4294967295},
    "table_pgno": {"min": 2, "max": 4294967295},
    "cursor_states": ["CURSOR_INVALID", "CURSOR_VALID", "CURSOR_REQUIRESEEK", "CURSOR_FAULT"],
    "transaction_states": ["TRANS_NONE", "TRANS_READ", "TRANS_WRITE"],
    "write_flags": ["BTREE_WRCSR", "BTREE_FORDELETE"],
    "create_flags": ["BTREE_INTKEY", "BTREE_LEAFDATA", "BTREE_ZERODATA"],
    "mutex_required": true,
    "write_transaction_required": true
  },
  "fc_mapping": {
    "btreeCreateTable": {
      "source": "btree.c:10015",
      "rationale": "Critical table creation function with page allocation and auto-vacuum handling",
      "api_level": "internal"
    },
    "btreeDropTable": {
      "source": "btree.c:10289", 
      "rationale": "Critical table deletion function with page movement and cleanup",
      "api_level": "internal"
    },
    "btreeCursor": {
      "source": "btree.c:4661",
      "rationale": "Core cursor creation function for table/index access",
      "api_level": "internal"
    },
    "btreeCursorWithLock": {
      "source": "btree.c:4728",
      "rationale": "Cursor creation with locking for shared cache scenarios",
      "api_level": "internal"
    }
  },
  "constraints": {
    "max_input_size": 8192,
    "min_input_size": 128,
    "endianness": "LE",
    "sqlite_version": "3.51.0",
    "requires_initialization": true,
    "requires_mutex": true,
    "requires_write_transaction": true,
    "requires_valid_btree": true
  },
  "notes": {
    "preconditions": [
      "sqlite3_initialize() called",
      "Valid Btree object with BtShared initialized",
      "Write transaction active for table operations",
      "Mutex held for shared cache scenarios",
      "Valid page allocation system"
    ],
    "side_effects": [
      "btreeCreateTable: Allocates new root page, updates metadata",
      "btreeDropTable: Frees pages, may move pages in auto-vacuum mode",
      "btreeCursor: Initializes cursor state, establishes locks",
      "btreeCursorWithLock: Additional locking for shared cache"
    ],
    "error_conditions": [
      "SQLITE_OK: Normal completion",
      "SQLITE_CORRUPT_PGNO: Invalid table page number",
      "SQLITE_LOCKED: Table locked by another connection",
      "SQLITE_NOMEM: Memory allocation failure",
      "SQLITE_READONLY: Database is read-only"
    ],
    "functional_relationships": [
      "btreeCreateTable creates tables that btreeCursor accesses",
      "btreeDropTable cleans up tables and their cursors",
      "btreeCursorWithLock extends btreeCursor with locking",
      "All functions interact with the same BtShared structure",
      "Table operations require cursor management"
    ],
    "coverage_targets": [
      "Table creation with different flags combinations",
      "Auto-vacuum scenarios during table operations",
      "Cursor state transitions and validation",
      "Lock acquisition and release patterns",
      "Page allocation and deallocation",
      "Shared cache locking mechanisms",
      "Error handling and rollback scenarios"
    ]
  }
}